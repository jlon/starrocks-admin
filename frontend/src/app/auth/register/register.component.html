<nb-layout>
  <nb-layout-column>
    <div class="auth-background">
      <div class="register-container">
        <div class="register-card">
          <!-- Left Side - Illustration -->
          <div class="illustration-section">
            <div class="tech-illustration">
              <div class="geometric-shapes">
                <div class="shape rocket-shape"></div>
                <div class="shape circle-shape"></div>
                <div class="shape triangle-shape"></div>
                <div class="shape line-shape"></div>
                <div class="shape dot-shape"></div>
                <div class="shape hexagon-shape"></div>
              </div>
            </div>
          </div>

          <!-- Right Side - Register Form -->
          <div class="form-section">
            <div class="form-content">
              <!-- Header -->
              <div class="brand-header">
                <div class="brand-logo">
                  <div class="logo-icon">
                    <nb-icon icon="person-add-outline"></nb-icon>
                  </div>
                  <h1 class="brand-name">Create Account</h1>
                </div>
                <p class="brand-tagline">Join StarRocks Admin Platform</p>
                <p class="welcome-text">Create your account to get started</p>
              </div>

          <!-- Alert Messages -->
          <nb-alert *ngFor="let error of errors" status="danger" closable (close)="errors = []">
            {{ error }}
          </nb-alert>
          <nb-alert *ngFor="let message of messages" status="success" closable (close)="messages = []">
            {{ message }}
          </nb-alert>

              <!-- Register Form -->
              <form (ngSubmit)="register()" #form="ngForm" class="register-form">
                <!-- Username Field -->
                <div class="form-group">
                  <label class="form-label" for="input-username">Username</label>
              <input 
                nbInput
                fullWidth
                [(ngModel)]="user.username"
                #username="ngModel"
                id="input-username"
                name="username"
                    placeholder="Enter your username"
                autofocus
                [status]="username.dirty ? (username.invalid  ? 'danger' : 'success') : 'basic'"
                [required]="true"
                [minlength]="3"
                [attr.aria-invalid]="username.invalid && username.touched ? true : null">
              <ng-container *ngIf="username.invalid && username.touched">
                    <p class="error-message" *ngIf="username.errors?.['required']">
                  Username is required!
                </p>
                    <p class="error-message" *ngIf="username.errors?.['minlength']">
                      Username must be at least 3 characters
                </p>
              </ng-container>
            </div>

                <!-- Email Field -->
                <div class="form-group">
                  <label class="form-label" for="input-email">Email Address</label>
              <input 
                nbInput
                fullWidth
                [(ngModel)]="user.email"
                #email="ngModel"
                type="email"
                id="input-email"
                name="email"
                    placeholder="Enter your email address"
                [status]="email.dirty ? (email.invalid  ? 'danger' : 'success') : 'basic'"
                [required]="true"
                pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
                [attr.aria-invalid]="email.invalid && email.touched ? true : null">
              <ng-container *ngIf="email.invalid && email.touched">
                    <p class="error-message" *ngIf="email.errors?.['required']">
                      Email address is required!
                </p>
                    <p class="error-message" *ngIf="email.errors?.['pattern']">
                      Please enter a valid email address
                </p>
              </ng-container>
            </div>

                <!-- Password Field -->
                <div class="form-group">
                  <label class="form-label" for="input-password">Password</label>
              <input 
                nbInput
                fullWidth
                [(ngModel)]="user.password"
                #password="ngModel"
                type="password"
                id="input-password"
                name="password"
                    placeholder="Enter your password"
                [status]="password.dirty ? (password.invalid  ? 'danger' : 'success') : 'basic'"
                [required]="true"
                [minlength]="6"
                [attr.aria-invalid]="password.invalid && password.touched ? true : null">
              <ng-container *ngIf="password.invalid && password.touched">
                    <p class="error-message" *ngIf="password.errors?.['required']">
                  Password is required!
                </p>
                    <p class="error-message" *ngIf="password.errors?.['minlength']">
                      Password must be at least 6 characters
                </p>
              </ng-container>
            </div>

                <!-- Confirm Password Field -->
                <div class="form-group">
                  <label class="form-label" for="input-confirm-password">Confirm Password</label>
              <input 
                nbInput
                fullWidth
                [(ngModel)]="user.confirmPassword"
                #confirmPassword="ngModel"
                type="password"
                id="input-confirm-password"
                name="confirmPassword"
                    placeholder="Confirm your password"
                [status]="confirmPassword.dirty ? (confirmPassword.invalid  ? 'danger' : 'success') : 'basic'"
                [required]="true"
                [attr.aria-invalid]="confirmPassword.invalid && confirmPassword.touched ? true : null">
              <ng-container *ngIf="user.password !== user.confirmPassword && confirmPassword.touched">
                    <p class="error-message">
                      Passwords do not match
                </p>
              </ng-container>
            </div>

                <!-- Avatar Selection -->
                <div class="form-group avatar-group">
                  <label class="form-label">Choose Your Avatar</label>
                  <p class="avatar-description">This will be your personal identifier on the platform</p>

                  <!-- Current Avatar Preview -->
                  <div class="avatar-preview-section">
                    <div class="current-avatar-large">
                      <img *ngIf="user.avatar" [src]="user.avatar" [alt]="'Selected Avatar'" class="preview-image">
                      <div *ngIf="!user.avatar" class="avatar-placeholder-large">
                        <nb-icon icon="person-outline"></nb-icon>
                      </div>
                    </div>
                  </div>

                  <!-- Avatar Options Grid -->
                  <div class="avatar-options-grid">
                    <div
                      *ngFor="let avatar of availableAvatars; let i = index"
                      class="avatar-option-small"
                      [class.selected]="user.avatar === avatar"
                      (click)="selectAvatar(avatar)">
                      <img [src]="avatar" [alt]="'Avatar Option'" class="option-image">
                    </div>
                  </div>

                  <!-- Refresh Button -->
                  <div class="refresh-section">
                    <button
                      type="button"
                      nbButton
                      status="basic"
                      size="small"
                      (click)="generateAvatarOptions()">
                      <nb-icon icon="refresh-outline"></nb-icon>
                      Generate New Set
                    </button>
                  </div>
                </div>

                <!-- Terms and Conditions -->
                <div class="terms-section">
                  <label class="checkbox-label">
                    <input type="checkbox" class="checkbox-input" required>
                    <span class="checkbox-text">I agree to the <a href="#" class="terms-link">Terms of Service</a> and <a href="#" class="terms-link">Privacy Policy</a></span>
                  </label>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
            <button 
              nbButton 
              fullWidth
                    status="primary"
              size="large"
              [disabled]="submitted || !form.valid"
                    [class.btn-pulse]="submitted"
                    class="register-button">
              <nb-icon *ngIf="submitted" icon="loader-outline" [options]="{animation: {type: 'pulse'}}"></nb-icon>
                    <nb-icon *ngIf="!submitted" icon="person-add-outline"></nb-icon>
                    <span *ngIf="!submitted">Create Account</span>
                    <span *ngIf="submitted">Creating Account...</span>
            </button>
                </div>

          <!-- Login Link -->
                <div class="login-link">
                  <p class="login-text">Already have an account? 
                    <a class="text-link" routerLink="../login">
                      <nb-icon icon="log-in-outline"></nb-icon>
                      Sign In
                    </a>
                  </p>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nb-layout-column>
</nb-layout>