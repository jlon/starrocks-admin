<div class="row">
  <div class="col-12">
    <nb-card>
      <nb-card-header>
        <div class="d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center gap-2">
            <h5 class="mb-0">物化视图</h5>
            <span class="text-hint">|</span>
            <span class="text-hint" style="font-size: 13px;">
              集群: <strong>{{ activeCluster?.name || '未选择' }}</strong>
            </span>
          </div>
          <div class="d-flex align-items-center gap-2">
            <button
              nbButton
              status="primary"
              size="small"
              (click)="loadMaterializedViews()"
              [disabled]="loading || !clusterId"
            >
              <nb-icon icon="refresh-outline"></nb-icon>
              刷新
            </button>
            <button
              nbButton
              status="success"
              size="small"
              (click)="openCreateDialog()"
              [disabled]="!clusterId"
            >
              <nb-icon icon="plus-outline"></nb-icon>
              创建
            </button>
          </div>
        </div>
      </nb-card-header>

      <nb-card-body>
        <!-- Basic Filters -->
        <div class="filter-section">
          <div class="row">
            <div class="col-md-3 col-sm-6 mb-2">
              <input
                nbInput
                fullWidth
                type="text"
                placeholder="搜索物化视图名称或数据库..."
                [(ngModel)]="searchText"
                (ngModelChange)="onSearch()"
              />
            </div>
            <div class="col-md-2 col-sm-6 mb-2">
              <nb-select
                fullWidth
                placeholder="选择数据库"
                [(selected)]="selectedDatabase"
                (selectedChange)="applyFilters()"
              >
                <nb-option value="all">所有数据库</nb-option>
                <nb-option *ngFor="let db of databases" [value]="db">
                  {{ db }}
                </nb-option>
              </nb-select>
            </div>
            <div class="col-md-2 col-sm-6 mb-2">
              <nb-select
                fullWidth
                placeholder="刷新类型"
                [(selected)]="selectedRefreshType"
                (selectedChange)="applyFilters()"
              >
                <nb-option
                  *ngFor="let option of refreshTypeOptions"
                  [value]="option.value"
                >
                  {{ option.label }}
                </nb-option>
              </nb-select>
            </div>
            <div class="col-md-2 col-sm-6 mb-2">
              <nb-select
                fullWidth
                placeholder="状态"
                [(selected)]="selectedActiveState"
                (selectedChange)="applyFilters()"
              >
                <nb-option
                  *ngFor="let option of activeStateOptions"
                  [value]="option.value"
                >
                  {{ option.label }}
                </nb-option>
              </nb-select>
            </div>
            <div class="col-md-2 col-sm-6 mb-2">
              <nb-select
                fullWidth
                placeholder="刷新状态"
                [(selected)]="selectedRefreshState"
                (selectedChange)="applyFilters()"
              >
                <nb-option
                  *ngFor="let option of refreshStateOptions"
                  [value]="option.value"
                >
                  {{ option.label }}
                </nb-option>
              </nb-select>
            </div>
            <div class="col-md-1 col-sm-12 mb-2">
              <button
                nbButton
                fullWidth
                status="info"
                size="small"
                (click)="toggleAdvancedFilters()"
              >
                <nb-icon
                  [icon]="showAdvancedFilters ? 'arrow-up-outline' : 'arrow-down-outline'"
                ></nb-icon>
                高级筛选
              </button>
            </div>
          </div>

          <!-- Advanced Filters -->
          <div *ngIf="showAdvancedFilters" class="advanced-filters mt-3">
            <nb-card accent="info">
              <nb-card-header>高级筛选</nb-card-header>
              <nb-card-body>
                <div class="row">
                  <div class="col-md-3 col-sm-6 mb-2">
                    <label class="label">刷新时间起始</label>
                    <input
                      nbInput
                      fullWidth
                      type="datetime-local"
                      [(ngModel)]="refreshTimeStart"
                      (ngModelChange)="applyFilters()"
                    />
                  </div>
                  <div class="col-md-3 col-sm-6 mb-2">
                    <label class="label">刷新时间结束</label>
                    <input
                      nbInput
                      fullWidth
                      type="datetime-local"
                      [(ngModel)]="refreshTimeEnd"
                      (ngModelChange)="applyFilters()"
                    />
                  </div>
                  <div class="col-md-2 col-sm-6 mb-2">
                    <label class="label">最小行数</label>
                    <input
                      nbInput
                      fullWidth
                      type="number"
                      placeholder="最小行数"
                      [(ngModel)]="rowCountMin"
                      (ngModelChange)="applyFilters()"
                    />
                  </div>
                  <div class="col-md-2 col-sm-6 mb-2">
                    <label class="label">最大行数</label>
                    <input
                      nbInput
                      fullWidth
                      type="number"
                      placeholder="最大行数"
                      [(ngModel)]="rowCountMax"
                      (ngModelChange)="applyFilters()"
                    />
                  </div>
                  <div class="col-md-2 col-sm-6 mb-2">
                    <label class="label">分区类型</label>
                    <nb-select
                      fullWidth
                      [(selected)]="selectedPartitionType"
                      (selectedChange)="applyFilters()"
                    >
                      <nb-option
                        *ngFor="let option of partitionTypeOptions"
                        [value]="option.value"
                      >
                        {{ option.label }}
                      </nb-option>
                    </nb-select>
                  </div>
                </div>
              </nb-card-body>
            </nb-card>
          </div>

          <!-- Active Filters Display -->
          <div *ngIf="getActiveFiltersCount() > 0" class="active-filters mt-2">
            <span class="me-2">当前筛选:</span>
            <nb-badge
              *ngIf="searchText"
              status="info"
              text="搜索: {{ searchText }}"
              class="me-2"
            ></nb-badge>
            <nb-badge
              *ngIf="selectedDatabase !== 'all'"
              status="info"
              text="数据库: {{ selectedDatabase }}"
              class="me-2"
            ></nb-badge>
            <nb-badge
              *ngIf="selectedRefreshType !== 'all'"
              status="info"
              text="类型: {{ selectedRefreshType }}"
              class="me-2"
            ></nb-badge>
            <nb-badge
              *ngIf="selectedActiveState !== 'all'"
              status="info"
              text="状态: {{ selectedActiveState }}"
              class="me-2"
            ></nb-badge>
            <nb-badge
              *ngIf="selectedRefreshState !== 'all'"
              status="info"
              text="刷新状态: {{ selectedRefreshState }}"
              class="me-2"
            ></nb-badge>
            <button
              nbButton
              size="tiny"
              status="danger"
              (click)="clearAllFilters()"
            >
              <nb-icon icon="close-outline"></nb-icon>
              清除全部
            </button>
          </div>
        </div>

        <!-- Loading Indicator -->
        <div *ngIf="loading" class="text-center mt-3">
          <nb-spinner status="primary"></nb-spinner>
        </div>

        <!-- Data Table -->
        <ng2-smart-table
          *ngIf="!loading"
          [settings]="settings"
          [source]="source"
          (edit)="onEdit($event)"
          (delete)="onDelete($event)"
        >
        </ng2-smart-table>
      </nb-card-body>
    </nb-card>
  </div>
</div>

<!-- Create Dialog -->
<ng-template #createDialog let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      <div class="d-flex justify-content-between align-items-center">
        <h5>创建物化视图</h5>
        <button nbButton ghost (click)="closeCreateDialog()">
          <nb-icon icon="close-outline"></nb-icon>
        </button>
      </div>
    </nb-card-header>
    <nb-card-body>
      <nb-accordion>
        <nb-accordion-item>
          <nb-accordion-item-header>SQL 模板示例（点击查看）</nb-accordion-item-header>
          <nb-accordion-item-body>
            <div class="template-section">
              <h6>异步物化视图（手动刷新）</h6>
              <pre class="code-template">CREATE MATERIALIZED VIEW mv_async_manual
DISTRIBUTED BY HASH(order_date) BUCKETS 10
REFRESH MANUAL
AS SELECT 
    order_date,
    SUM(amount) as daily_sales,
    COUNT(*) as order_count
FROM orders
GROUP BY order_date;</pre>

              <h6>异步物化视图（自动刷新）</h6>
              <pre class="code-template">CREATE MATERIALIZED VIEW mv_async_auto
DISTRIBUTED BY HASH(order_date) BUCKETS 10
REFRESH ASYNC EVERY (INTERVAL 1 HOUR)
AS SELECT 
    order_date,
    SUM(amount) as daily_sales
FROM orders
GROUP BY order_date;</pre>

              <h6>同步物化视图（ROLLUP，导入时自动刷新）</h6>
              <pre class="code-template">CREATE MATERIALIZED VIEW mv_sync_rollup
AS SELECT 
    customer_id,
    order_date,
    SUM(amount) as total_amount,
    COUNT(*) as order_count
FROM orders
GROUP BY customer_id, order_date;</pre>
            </div>
          </nb-accordion-item-body>
        </nb-accordion-item>
      </nb-accordion>

      <div class="form-group mt-3">
        <label class="label">CREATE MATERIALIZED VIEW SQL 语句</label>
        <textarea
          nbInput
          fullWidth
          rows="12"
          placeholder="输入完整的 CREATE MATERIALIZED VIEW 语句..."
          [(ngModel)]="createSQL"
          [disabled]="creating"
        ></textarea>
        <small class="form-text text-muted">
          <nb-icon icon="bulb-outline"></nb-icon>
          请输入完整的CREATE MATERIALIZED VIEW SQL语句。异步MV需要DISTRIBUTED BY，同步MV（ROLLUP）无需DISTRIBUTED BY。
        </small>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <div class="d-flex justify-content-end gap-2">
        <button
          nbButton
          status="basic"
          (click)="closeCreateDialog()"
          [disabled]="creating"
        >
          取消
        </button>
        <button
          nbButton
          status="primary"
          (click)="createMV()"
          [disabled]="creating || !createSQL.trim()"
        >
          <nb-icon icon="checkmark-outline"></nb-icon>
          {{ creating ? '创建中...' : '创建' }}
        </button>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- Detail Dialog -->
<ng-template #detailDialog let-data let-ref="dialogRef">
  <nb-card *ngIf="selectedMV">
    <nb-card-header>
      <div class="d-flex justify-content-between align-items-center">
        <h5>物化视图详情: {{ selectedMV.name }}</h5>
        <button nbButton ghost (click)="closeDetailDialog()">
          <nb-icon icon="close-outline"></nb-icon>
        </button>
      </div>
    </nb-card-header>
    <nb-card-body>
      <nb-tabset>
        <nb-tab tabTitle="基本信息">
          <div class="detail-section">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="label">名称</label>
                <p>{{ selectedMV.name }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">数据库</label>
                <p>{{ selectedMV.database_name }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">刷新类型</label>
                <p [innerHTML]="getRefreshTypeBadge(selectedMV.refresh_type)"></p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">状态</label>
                <p>
                  <span *ngIf="selectedMV.is_active" class="badge badge-success">Active</span>
                  <span *ngIf="!selectedMV.is_active" class="badge badge-warning">Inactive</span>
                </p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">分区类型</label>
                <p>{{ selectedMV.partition_type || '-' }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">行数</label>
                <p>{{ selectedMV.rows || '-' }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">任务ID</label>
                <p>{{ selectedMV.task_id || '-' }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">任务名称</label>
                <p>{{ selectedMV.task_name || '-' }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">最后刷新开始时间</label>
                <p>{{ selectedMV.last_refresh_start_time || '-' }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">最后刷新完成时间</label>
                <p>{{ selectedMV.last_refresh_finished_time || '-' }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">最后刷新耗时</label>
                <p>{{ selectedMV.last_refresh_duration || '-' }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="label">最后刷新状态</label>
                <p [innerHTML]="getRefreshStateBadge(selectedMV.last_refresh_state)"></p>
              </div>
              
              <!-- Error information -->
              <div class="col-12 mb-3" *ngIf="selectedMV.last_refresh_error_message">
                <label class="label">刷新错误信息</label>
                <nb-alert status="danger" closable="false">
                  <strong>错误码：</strong>{{ selectedMV.last_refresh_error_code || '-' }}<br>
                  <strong>错误信息：</strong>{{ selectedMV.last_refresh_error_message }}
                </nb-alert>
              </div>
              
              <!-- Partition information -->
              <div class="col-md-6 mb-3" *ngIf="selectedMV.last_refresh_start_partition">
                <label class="label">最后刷新起始分区</label>
                <p>{{ selectedMV.last_refresh_start_partition }}</p>
              </div>
              <div class="col-md-6 mb-3" *ngIf="selectedMV.last_refresh_end_partition">
                <label class="label">最后刷新结束分区</label>
                <p>{{ selectedMV.last_refresh_end_partition }}</p>
              </div>
              
              <!-- Force refresh flag -->
              <div class="col-md-6 mb-3" *ngIf="selectedMV.last_refresh_force_refresh !== undefined && selectedMV.last_refresh_force_refresh !== null">
                <label class="label">强制刷新</label>
                <p>
                  <span *ngIf="selectedMV.last_refresh_force_refresh" class="badge badge-warning">是</span>
                  <span *ngIf="!selectedMV.last_refresh_force_refresh" class="badge badge-basic">否</span>
                </p>
              </div>
            </div>
          </div>
        </nb-tab>
        <nb-tab tabTitle="DDL语句">
          <div class="ddl-section">
            <textarea
              nbInput
              fullWidth
              rows="20"
              [value]="mvDDL"
              readonly
            ></textarea>
          </div>
        </nb-tab>
      </nb-tabset>
    </nb-card-body>
    <nb-card-footer>
      <div class="d-flex justify-content-between">
        <div class="d-flex gap-2">
          <button nbButton status="info" size="small" (click)="closeDetailDialog(); openEditDialog(selectedMV)">
            <nb-icon icon="edit-outline"></nb-icon>
            编辑
          </button>
          <button 
            *ngIf="selectedMV.refresh_type !== 'ROLLUP'" 
            nbButton 
            status="success" 
            size="small" 
            (click)="closeDetailDialog(); openRefreshDialog(selectedMV)"
          >
            <nb-icon icon="refresh-outline"></nb-icon>
            刷新
          </button>
          <button 
            *ngIf="selectedMV.refresh_type !== 'ROLLUP'" 
            nbButton 
            [status]="selectedMV.is_active ? 'warning' : 'success'" 
            size="small" 
            (click)="closeDetailDialog(); toggleActiveState(selectedMV)"
          >
            <nb-icon icon="power-outline"></nb-icon>
            {{ selectedMV.is_active ? '停用' : '激活' }}
          </button>
        </div>
        <button nbButton status="basic" (click)="closeDetailDialog()">
          关闭
        </button>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- Refresh Dialog -->
<ng-template #refreshDialog let-data let-ref="dialogRef">
  <nb-card *ngIf="selectedMV">
    <nb-card-header>
      <div class="d-flex justify-content-between align-items-center">
        <h5>刷新物化视图: {{ selectedMV.name }}</h5>
        <button nbButton ghost (click)="closeRefreshDialog()">
          <nb-icon icon="close-outline"></nb-icon>
        </button>
      </div>
    </nb-card-header>
    <nb-card-body>
      <div class="form-group">
        <label class="label">刷新模式</label>
        <nb-select fullWidth [(selected)]="refreshMode">
          <nb-option *ngFor="let option of refreshModeOptions" [value]="option.value">
            {{ option.label }}
          </nb-option>
        </nb-select>
        <small class="form-text text-muted">
          ASYNC: 异步刷新（后台执行），SYNC: 同步刷新（阻塞等待完成）
        </small>
      </div>

      <div class="form-group mt-3">
        <nb-checkbox [(checked)]="refreshForce">
          强制刷新 (FORCE)
        </nb-checkbox>
        <small class="form-text text-muted d-block">
          即使数据未变化也强制刷新物化视图
        </small>
      </div>

      <div class="form-group mt-3" *ngIf="selectedMV.partition_type && selectedMV.partition_type !== 'UNPARTITIONED'">
        <label class="label">分区刷新 (可选)</label>
        <div class="row">
          <div class="col-md-6">
            <input
              nbInput
              fullWidth
              type="text"
              placeholder="起始分区"
              [(ngModel)]="refreshPartitionStart"
            />
          </div>
          <div class="col-md-6">
            <input
              nbInput
              fullWidth
              type="text"
              placeholder="结束分区"
              [(ngModel)]="refreshPartitionEnd"
            />
          </div>
        </div>
        <small class="form-text text-muted">
          <nb-icon icon="info-outline"></nb-icon>
          留空刷新所有分区，或指定分区范围仅刷新部分分区
        </small>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <div class="d-flex justify-content-end gap-2">
        <button
          nbButton
          status="basic"
          (click)="closeRefreshDialog()"
          [disabled]="refreshing"
        >
          取消
        </button>
        <button
          nbButton
          status="primary"
          (click)="refreshMV()"
          [disabled]="refreshing"
        >
          <nb-icon icon="refresh-outline"></nb-icon>
          {{ refreshing ? '刷新中...' : '开始刷新' }}
        </button>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>

<!-- Edit Dialog -->
<ng-template #editDialog let-data let-ref="dialogRef">
  <nb-card>
    <nb-card-header>
      <div class="d-flex justify-content-between align-items-center">
        <h5>编辑物化视图: {{ selectedMV?.name }}</h5>
        <button nbButton ghost (click)="closeEditDialog()">
          <nb-icon icon="close-outline"></nb-icon>
        </button>
      </div>
    </nb-card-header>
    <nb-card-body>
      <div class="form-group">
        <label class="label">操作类型</label>
        <nb-select [(selected)]="editAction" fullWidth>
          <nb-option value="rename">重命名</nb-option>
          <nb-option value="refresh_strategy">修改刷新策略</nb-option>
          <nb-option value="properties">修改属性</nb-option>
          <nb-option value="advanced">高级模式（自定义ALTER子句）</nb-option>
        </nb-select>
      </div>

      <!-- Rename Form -->
      <div *ngIf="editAction === 'rename'" class="form-group">
        <label class="label">新名称 <span class="text-danger">*</span></label>
        <input
          nbInput
          fullWidth
          type="text"
          [(ngModel)]="editNewName"
          placeholder="输入新的物化视图名称"
        />
        <p class="caption text-hint mt-2">
          <nb-icon icon="info-outline"></nb-icon>
          将生成SQL: ALTER MATERIALIZED VIEW {{ selectedMV?.database_name }}.{{ selectedMV?.name }} RENAME {{ editNewName }}
        </p>
      </div>

      <!-- Refresh Strategy Form -->
      <div *ngIf="editAction === 'refresh_strategy'">
        <div class="form-group">
          <label class="label">刷新策略 <span class="text-danger">*</span></label>
          <nb-select [(selected)]="editRefreshStrategy" fullWidth>
            <nb-option value="MANUAL">手动刷新 (MANUAL)</nb-option>
            <nb-option value="ASYNC">自动刷新 (ASYNC)</nb-option>
          </nb-select>
        </div>

        <div *ngIf="editRefreshStrategy === 'ASYNC'" class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label class="label">刷新间隔</label>
              <input
                nbInput
                fullWidth
                type="number"
                min="1"
                [(ngModel)]="editRefreshInterval"
                placeholder="1"
              />
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label class="label">时间单位</label>
              <nb-select [(selected)]="editRefreshUnit" fullWidth>
                <nb-option value="HOUR">小时</nb-option>
                <nb-option value="DAY">天</nb-option>
                <nb-option value="WEEK">周</nb-option>
                <nb-option value="MONTH">月</nb-option>
              </nb-select>
            </div>
          </div>
        </div>

        <p class="caption text-hint mt-2">
          <nb-icon icon="info-outline"></nb-icon>
          <span *ngIf="editRefreshStrategy === 'MANUAL'">
            将生成SQL: ALTER MATERIALIZED VIEW ... REFRESH MANUAL
          </span>
          <span *ngIf="editRefreshStrategy === 'ASYNC'">
            将生成SQL: ALTER MATERIALIZED VIEW ... REFRESH ASYNC EVERY(INTERVAL {{ editRefreshInterval }} {{ editRefreshUnit }})
          </span>
        </p>
      </div>

      <!-- Properties Form -->
      <div *ngIf="editAction === 'properties'">
        <div class="form-group">
          <label class="label">属性名称 <span class="text-danger">*</span></label>
          <input
            nbInput
            fullWidth
            type="text"
            [(ngModel)]="editPropertyKey"
            placeholder="例如: session.enable_profile 或 mv_rewrite_staleness_second"
          />
        </div>
        <div class="form-group">
          <label class="label">属性值 <span class="text-danger">*</span></label>
          <input
            nbInput
            fullWidth
            type="text"
            [(ngModel)]="editPropertyValue"
            placeholder="输入属性值"
          />
        </div>

        <nb-accordion class="mt-3">
          <nb-accordion-item>
            <nb-accordion-item-header>常用属性说明</nb-accordion-item-header>
            <nb-accordion-item-body>
              <ul class="list-unstyled small">
                <li><strong>session.enable_profile</strong> - 启用Profile (true/false)</li>
                <li><strong>session.enable_spill</strong> - 启用中间结果落盘 (true/false)</li>
                <li><strong>session.spill_mode</strong> - 落盘模式 (auto/force)</li>
                <li><strong>mv_rewrite_staleness_second</strong> - 查询改写Staleness时间（秒）</li>
                <li><strong>partition_ttl_number</strong> - 分区TTL数量</li>
                <li><strong>partition_refresh_number</strong> - 分区刷新数量</li>
              </ul>
            </nb-accordion-item-body>
          </nb-accordion-item>
        </nb-accordion>

        <p class="caption text-hint mt-2">
          <nb-icon icon="info-outline"></nb-icon>
          将生成SQL: ALTER MATERIALIZED VIEW ... SET ("{{ editPropertyKey }}" = "{{ editPropertyValue }}")
        </p>
      </div>

      <!-- Advanced Form -->
      <div *ngIf="editAction === 'advanced'">
        <div class="form-group">
          <label class="label">ALTER子句 <span class="text-danger">*</span></label>
          <textarea
            nbInput
            fullWidth
            rows="4"
            [(ngModel)]="editAdvancedClause"
            placeholder="例如: ACTIVE, INACTIVE, SWAP WITH other_mv, SET (...) 等"
          ></textarea>
        </div>

        <nb-alert status="info" closable="false">
          <strong>支持的ALTER子句:</strong>
          <ul class="mb-0 mt-2">
            <li><code>RENAME new_name</code> - 重命名</li>
            <li><code>REFRESH MANUAL</code> 或 <code>REFRESH ASYNC EVERY(...)</code> - 修改刷新策略</li>
            <li><code>ACTIVE</code> 或 <code>INACTIVE</code> - 修改状态</li>
            <li><code>SET ("key" = "value")</code> - 修改属性</li>
            <li><code>SWAP WITH other_mv_name</code> - 原子替换</li>
          </ul>
        </nb-alert>

        <p class="caption text-hint mt-2">
          <nb-icon icon="alert-triangle-outline"></nb-icon>
          请确保ALTER子句语法正确，完整SQL将为: ALTER MATERIALIZED VIEW {{ selectedMV?.database_name }}.{{ selectedMV?.name }} {{ editAdvancedClause }}
        </p>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <div class="d-flex justify-content-end gap-2">
        <button
          nbButton
          status="basic"
          (click)="closeEditDialog()"
          [disabled]="editing"
        >
          取消
        </button>
        <button
          nbButton
          status="primary"
          (click)="editMV()"
          [disabled]="editing"
        >
          <nb-icon icon="checkmark-outline"></nb-icon>
          {{ editing ? '修改中...' : '确认修改' }}
        </button>
      </div>
    </nb-card-footer>
  </nb-card>
</ng-template>
