<nb-card class="organization-dialog">
  <nb-card-header>
    <div class="dialog-header">
      <div>
        <h5>{{ (mode === 'create' ? 'organizations.create_organization' : 'organizations.edit_organization') | translate }}</h5>
        <p class="dialog-subtitle">
          {{ (mode === 'create' ? 'organizations.create_subtitle' : 'organizations.edit_subtitle') | translate }}
        </p>
      </div>
      <button nbButton ghost status="basic" size="small" (click)="cancel()">
        <nb-icon icon="close-outline"></nb-icon>
      </button>
    </div>
  </nb-card-header>

  <nb-card-body>
    <form [formGroup]="form" class="organization-form" novalidate>
      <div class="form-container">
        <!-- Code (only in create mode) -->
        <div class="form-group" *ngIf="mode === 'create'">
          <label class="label" for="input-code">{{ 'organizations.code' | translate }}</label>
          <nb-form-field>
            <input
              nbInput
              fullWidth
              id="input-code"
              [placeholder]="'organizations.code_placeholder' | translate"
              formControlName="code"
              [status]="form.get('code')?.invalid && form.get('code')?.touched ? 'danger' : 'basic'"
              maxlength="50"
            />
          </nb-form-field>
          <ng-container *ngIf="form.get('code')?.invalid && form.get('code')?.touched">
            <p class="caption status-danger" *ngIf="form.get('code')?.errors?.['required']">
              {{ 'organizations.code_required' | translate }}
            </p>
            <p class="caption status-danger" *ngIf="form.get('code')?.errors?.['pattern']">
              {{ 'organizations.code_pattern' | translate }}
            </p>
          </ng-container>
        </div>

        <!-- Name -->
        <div class="form-group">
          <label class="label" for="input-name">{{ 'organizations.name' | translate }}</label>
          <nb-form-field>
            <input
              nbInput
              fullWidth
              id="input-name"
              [placeholder]="'organizations.name_placeholder' | translate"
              formControlName="name"
              [status]="form.get('name')?.invalid && form.get('name')?.touched ? 'danger' : 'basic'"
              maxlength="100"
            />
          </nb-form-field>
          <ng-container *ngIf="form.get('name')?.invalid && form.get('name')?.touched">
            <p class="caption status-danger" *ngIf="form.get('name')?.errors?.['required']">
              {{ 'organizations.name_required' | translate }}
            </p>
          </ng-container>
        </div>

        <!-- Description -->
        <div class="form-group">
          <label class="label" for="input-description">{{ 'organizations.description' | translate }}</label>
          <nb-form-field>
            <textarea
              nbInput
              fullWidth
              id="input-description"
              [placeholder]="'organizations.description_placeholder' | translate"
              formControlName="description"
              rows="3"
              maxlength="500"
            ></textarea>
          </nb-form-field>
        </div>

        <!-- Admin Section (only in edit mode) -->
        <div class="form-group" *ngIf="mode === 'edit'">
          <label class="label" for="input-admin-user-id">{{ 'organizations.admin_user' | translate }}</label>
          <nb-form-field>
            <nb-select
              formControlName="admin_user_id"
              id="input-admin-user-id"
              [placeholder]="'organizations.admin_user_placeholder' | translate"
              fullWidth
            >
              <nb-option *ngFor="let user of availableUsers; trackBy: trackByUserId" [value]="user.id">
                {{ user.username }} <span class="hint" *ngIf="user.email">- {{ user.email }}</span>
              </nb-option>
              <nb-option *ngIf="availableUsers.length === 0" disabled>{{ 'organizations.no_users_in_org' | translate }}</nb-option>
            </nb-select>
          </nb-form-field>
          <p class="caption status-hint">
            {{ 'organizations.admin_user_hint' | translate }}
          </p>
        </div>
      </div>
    </form>
  </nb-card-body>

  <nb-card-footer>
    <div class="footer-actions">
      <button nbButton ghost status="basic" (click)="cancel()">{{ 'common.cancel' | translate }}</button>
      <button nbButton status="primary" (click)="submit()" [disabled]="form.invalid">
        {{ (mode === 'create' ? 'organizations.create_organization' : 'organizations.save_changes') | translate }}
      </button>
    </div>
  </nb-card-footer>
</nb-card>
